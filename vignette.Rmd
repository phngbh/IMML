---
title: "IMML vignette"
author: "Wilhelm Glaas"
date: "`r Sys.Date()`"
output: html_document
runtime: shiny
---

```{r message=FALSE, warning=FALSE}
library(IMLpackage)
options(scipen = 999)

dat <- readRDS("~/Helmholtz/data_IMML/DataPartitioning/dataIDs.rds")
phen <- readRDS("~/Helmholtz/data_IMML/DataPartitioning/mnsi.rds")
```

```{r echo=FALSE}
head(dat)
head(phen)
```

Creating the data partition for the inc3 phenotype

```{r}
part <- DataPartitioning(dataIDs = dat, phenotypeIDs = phen, phenotype = 'inc3')
str(part, list.len = 3)
```

```{r echo=FALSE, out.width='100%', fig.align='center', fig.width=9}

purpose = rep(c('Testing', 'Training'),
                     each = length(part$testingFeatureSelectionIDs) + 1)
partition = factor(rep(c(names(part[1]), names(part$testingFeatureSelectionIDs)),
                       times = 2),
                   levels = c(names(part[1]),
                              names(part$testingFeatureSelectionIDs)))
train_amount = c(length(unlist(part$modeltraining$Iteration1$Training)),
                 unname(lapply(part$trainingFeatureSelection,
                               function(x) length(x[[1]]))))
test_amount = c(length(part$modeltraining$Iteration1$Testing),
                 unname(lapply(part$testingFeatureSelectionIDs,
                               function(x) length(x[[1]]))))
amount = unlist(c(train_amount, test_amount))
plt_df = data.frame(purpose, partition, amount)

plt = ggplot(plt_df, aes(x = partition, y = amount,
                   group = purpose, color = purpose, fill = purpose)) +
  geom_bar(stat = "identity", position = position_dodge(), alpha = 0.75)
plt
```
